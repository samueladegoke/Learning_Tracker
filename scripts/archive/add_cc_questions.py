import json
from pathlib import Path

cc_questions = {
    7: [
        {'question_type': 'code-correction', 'text': 'The hangman game crashes with IndexError. Fix it.', 'code': 'word = "hello"\nguess = "z"\nif word[guess]:', 'options': ['Use "in" operator: if guess in word:', 'Use find() method', 'Convert guess to int', 'Use word.index(guess)'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'strings', 'explanation': 'Use "in" keyword to check if a character exists in a string, not indexing.'},
        {'question_type': 'code-correction', 'text': 'The display string is not updating correctly. Debug it.', 'code': 'display = "_____"\ndisplay[0] = "h"', 'options': ['Strings are immutable; use a list instead: display = list("_____")', 'Use display.replace()', 'Use display += "h"', 'Cast to mutable string'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'strings', 'explanation': 'Strings are immutable in Python. Convert to a list to modify individual characters.'},
        {'question_type': 'code-correction', 'text': 'The game continues even when the word is guessed. Fix the condition.', 'code': 'while "_" in display and lives > 0:\n    if display == word:', 'options': ['Compare as strings: if "".join(display) == word: when using list', 'Use display is word', 'Use display.equals(word)', 'Remove the while condition'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'control_flow', 'explanation': 'If display is a list, join it to compare with the word string.'},
    ],
    8: [
        {'question_type': 'code-correction', 'text': 'The function returns None instead of the result. Fix it.', 'code': 'def add(a, b):\n    result = a + b\n\nprint(add(3, 5))', 'options': ['Add return statement: return result', 'Change print to return in the call', 'Use global result', 'Add print(result) in function'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'functions', 'explanation': 'Functions need a return statement to send values back. Without return, they return None.'},
        {'question_type': 'code-correction', 'text': 'The Caesar cipher wraps incorrectly past z. Debug it.', 'code': 'new_index = ord(letter) + shift\nnew_letter = chr(new_index)', 'options': ['Use modulo to wrap: new_index = (ord(letter) - 97 + shift) % 26 + 97', 'Use abs(new_index)', 'Use int(new_index)', 'Subtract shift instead'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'caesar_cipher', 'explanation': 'Use modulo 26 to wrap the alphabet.'},
        {'question_type': 'code-correction', 'text': 'The function parameter is not using the passed value. Debug it.', 'code': 'def greet(name):\n    name = "World"\n    print(f"Hello, {name}!")', 'options': ['Remove the reassignment name = "World"', 'Use global name', 'Pass name by reference', 'Use *name'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'functions', 'explanation': 'The parameter is immediately overwritten. Remove the reassignment.'},
    ],
    9: [
        {'question_type': 'code-correction', 'text': 'The dictionary access throws KeyError. Fix it.', 'code': 'student = {"name": "Alice", "age": 20}\nprint(student["grade"])', 'options': ['Use .get() method: student.get("grade", "N/A")', 'Use student("grade")', 'Use student.grade', 'Add quotes around student'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'dictionaries', 'explanation': '.get() returns None or a default value if the key does not exist.'},
        {'question_type': 'code-correction', 'text': 'Adding a new key-value pair is not working. Debug it.', 'code': 'scores = {}\nscores.add("Alice", 100)', 'options': ['Use assignment syntax: scores["Alice"] = 100', 'Use scores.insert("Alice", 100)', 'Use scores.append({"Alice": 100})', 'Use scores.update("Alice")'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'dictionaries', 'explanation': 'Dictionaries use bracket notation: dict[key] = value'},
        {'question_type': 'code-correction', 'text': 'The nested dictionary access fails. Fix the syntax.', 'code': 'travel = {"France": {"cities": ["Paris", "Lyon"]}}\nprint(travel.France.cities)', 'options': ['Use bracket notation: travel["France"]["cities"]', 'Use travel->France->cities', 'Use travel.get.France.cities', 'Cast to object first'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'dictionaries', 'explanation': 'Python dicts use bracket notation, not dot notation.'},
    ],
    10: [
        {'question_type': 'code-correction', 'text': 'The function should return multiple values. Fix it.', 'code': 'def min_max(numbers):\n    return min(numbers)', 'options': ['Return a tuple: return min(numbers), max(numbers)', 'Use return [min, max]', 'Call return twice', 'Use yield instead'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'functions', 'explanation': 'Return multiple values as a tuple: return value1, value2'},
        {'question_type': 'code-correction', 'text': 'The docstring is not showing in help(). Fix the placement.', 'code': 'def calculate():\n    result = 42\n    """Returns a calculation result"""\n    return result', 'options': ['Move docstring to first line after def', 'Use # comment instead', 'Add print before docstring', 'Use help= parameter'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'documentation', 'explanation': 'Docstrings must be the first statement in a function body.'},
        {'question_type': 'code-correction', 'text': 'The returned value is a string instead of number. Fix it.', 'code': 'def add_numbers():\n    a = input("First: ")\n    b = input("Second: ")\n    return a + b', 'options': ['Convert inputs to int: return int(a) + int(b)', 'Use sum(a, b)', 'Use a - b', 'Remove the + operator'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'type_conversion', 'explanation': 'input() returns strings. Convert to int for math.'},
    ],
    11: [
        {'question_type': 'code-correction', 'text': 'The ace value logic is wrong. Fix the conditional.', 'code': 'ace_value = 11 or 1', 'options': ['Use conditional: ace_value = 11 if total <= 10 else 1', 'Use ace_value = 11 | 1', 'Use random.choice([11, 1])', 'Remove the or'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'game_logic', 'explanation': '"or" returns the first truthy value. Use conditional logic.'},
        {'question_type': 'code-correction', 'text': 'The card dealing always gives the same card. Debug it.', 'code': 'import random\ncards = [11, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]\ncard = cards[0]', 'options': ['Use random.choice(cards)', 'Use cards.pop()', 'Use cards.random()', 'Sort cards first'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'random', 'explanation': 'cards[0] always gets the first card. Use random.choice().'},
        {'question_type': 'code-correction', 'text': 'The score comparison uses wrong operator. Fix it.', 'code': 'if user_score = 21:\n    print("Blackjack!")', 'options': ['Use == for comparison: if user_score == 21:', 'Use === operator', 'Use is 21', 'Use equals(21)'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'operators', 'explanation': '= is assignment, == is comparison.'},
    ],
    12: [
        {'question_type': 'code-correction', 'text': 'The global variable is not updating. Fix it.', 'code': 'score = 0\ndef increase_score():\n    score = score + 1', 'options': ['Add global keyword: global score', 'Use score := score + 1', 'Pass score as parameter', 'Use external score'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'scope', 'explanation': 'To modify a global variable, use the global keyword.'},
        {'question_type': 'code-correction', 'text': 'The inner function cannot access outer variable. Debug it.', 'code': 'def outer():\n    x = 10\n    def inner():\n        x = x + 1\n    inner()\n    return x', 'options': ['Use nonlocal x in inner function', 'Use global x', 'Pass x as parameter', 'Remove inner function'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'scope', 'explanation': 'Use nonlocal to modify an enclosing scope variable.'},
        {'question_type': 'code-correction', 'text': 'The constant is being modified. Fix the convention.', 'code': 'PI = 3.14159\nPI = 3.14', 'options': ['Remove the second assignment - constants should not be reassigned', 'Use const PI', 'Use PI.freeze()', 'Use immutable(PI)'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'scope', 'explanation': 'Python uses UPPER_CASE naming convention for constants.'},
    ],
    13: [
        {'question_type': 'code-correction', 'text': 'The comparison evaluates incorrectly. Debug it.', 'code': 'age = input("Age: ")\nif age > 18:\n    print("Adult")', 'options': ['Convert to int: if int(age) > 18:', 'Use age.value > 18', 'Use age >= 18', 'Remove quotes from 18'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'debugging', 'explanation': 'input() returns a string. Convert to int for comparison.'},
        {'question_type': 'code-correction', 'text': 'The code has an off-by-one error. Fix it.', 'code': 'for i in range(1, 100):\n    print(i)', 'options': ['Use range(1, 101) to include 100', 'Add print(100) after loop', 'Use range(0, 100)', 'Use <= in condition'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'debugging', 'explanation': 'range() excludes the stop value. Use range(1, 101).'},
        {'question_type': 'code-correction', 'text': 'The variable is used before assignment. Debug it.', 'code': 'print(message)\nmessage = "Hello World"', 'options': ['Define variable before using: move message = "Hello World" above print', 'Use declare message', 'Use lazy message', 'Add quotes around message in print'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'debugging', 'explanation': 'Variables must be defined before they are used.'},
    ],
    14: [
        {'question_type': 'code-correction', 'text': 'The random selection picks the same item twice. Fix it.', 'code': 'import random\nperson_a = random.choice(data)\nperson_b = random.choice(data)', 'options': ['Use random.sample(data, 2) for unique items', 'Remove person_a from data first', 'Check if same and repick', 'Use random.unique()'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'random', 'explanation': 'Use random.sample(data, 2) to get 2 unique items.'},
        {'question_type': 'code-correction', 'text': 'The comparison returns wrong result for equal values.', 'code': 'if followers_a > followers_b:\n    answer = "a"\nelse:\n    answer = "b"', 'options': ['Add elif for equality: elif followers_a == followers_b: answer = "tie"', 'Use >= instead', 'Swap the conditions', 'Use max() function'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'game_logic', 'explanation': 'Handle the tie case explicitly with elif.'},
        {'question_type': 'code-correction', 'text': 'The game data access syntax is wrong. Fix it.', 'code': 'data = [{"name": "A", "followers": 100}]\nprint(data.name)', 'options': ['Use indexing and key: data[0]["name"]', 'Use data->name', 'Use data.get(name)', 'Use data("name")'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'dictionaries', 'explanation': 'data is a list of dicts. Access list item [0], then dict key ["name"].'},
    ],
    15: [
        {'question_type': 'code-correction', 'text': 'The resource check always passes. Debug the condition.', 'code': 'if resources["water"] > recipe["water"]:', 'options': ['Use >= for sufficient resources', 'Use == instead', 'Swap the comparison', 'Use .has() method'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'logic', 'explanation': 'Check if resources are greater than OR EQUAL to requirements.'},
        {'question_type': 'code-correction', 'text': 'The money calculation loses precision. Fix the float issue.', 'code': 'total = 0.1 + 0.2\nif total == 0.3:', 'options': ['Use round() for comparison: if round(total, 2) == 0.3:', 'Use total is 0.3', 'Use decimal module', 'Use int(total) == 0'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'floats', 'explanation': 'Floating point arithmetic has precision issues. Use round().'},
        {'question_type': 'code-correction', 'text': 'The recipe lookup fails. Debug the dictionary access.', 'code': 'recipes = {"espresso": {}}\nrecipe = recipes[user_choice]', 'options': ['Use lowercase: recipe = recipes[user_choice.lower()]', 'Use case-insensitive dict', 'Add "Espresso" to recipes', 'Use recipes.get()'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'strings', 'explanation': 'Dictionary keys are case-sensitive. Convert input to lowercase.'},
    ],
    16: [
        {'question_type': 'code-correction', 'text': 'The class instantiation syntax is wrong. Fix it.', 'code': 'my_car = Car.new("red")', 'options': ['Use parentheses: my_car = Car("red")', 'Use Car.create("red")', 'Use new Car("red")', 'Use Car.init("red")'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'oop', 'explanation': 'Instantiate classes with ClassName(args), not .new().'},
        {'question_type': 'code-correction', 'text': 'The method is missing the self parameter. Fix it.', 'code': 'class Dog:\n    def bark():\n        print("Woof!")', 'options': ['Add self parameter: def bark(self):', 'Use @staticmethod', 'Remove the class', 'Use def bark(@self):'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'oop', 'explanation': 'Instance methods need self as the first parameter.'},
        {'question_type': 'code-correction', 'text': 'The attribute access is failing. Debug the init method.', 'code': 'class Person:\n    def __init__(self, name):\n        name = name\n\np = Person("Alice")\nprint(p.name)', 'options': ['Use self.name = name to store on object', 'Use this.name = name', 'Use Person.name = name', 'Add @property decorator'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'oop', 'explanation': 'Use self.attribute = value to store attributes.'},
    ],
    19: [
        {'question_type': 'code-correction', 'text': 'The event listener is not working. Debug the binding.', 'code': 'screen.onkey(move_forward(), "Up")', 'options': ['Remove parentheses: screen.onkey(move_forward, "Up")', 'Use screen.bind("Up", move_forward)', 'Add return to move_forward', 'Use lambda instead'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'events', 'explanation': 'Pass function reference without parentheses.'},
        {'question_type': 'code-correction', 'text': 'The keyboard input is not responding. Fix the screen setup.', 'code': 'screen.onkey(go_up, "Up")', 'options': ['Add screen.listen() after binding keys', 'Use screen.wait()', 'Add time.sleep(1)', 'Use input() instead'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'events', 'explanation': 'screen.listen() is required to start listening for key events.'},
        {'question_type': 'code-correction', 'text': 'The turtle position is not updating. Debug the method call.', 'code': 'turtle.forward\nturtle.left', 'options': ['Add parentheses: turtle.forward(100)', 'Use turtle.move()', 'Use turtle->forward', 'Add self before turtle'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'turtle', 'explanation': 'Methods need parentheses to be called.'},
    ],
    20: [
        {'question_type': 'code-correction', 'text': 'The time.sleep() is making the game unresponsive. Debug it.', 'code': 'while True:\n    time.sleep(10)\n    snake.move()', 'options': ['Use smaller delay: time.sleep(0.1)', 'Remove time.sleep entirely', 'Use snake.sleep(10)', 'Move sleep after move()'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'timing', 'explanation': 'Long sleep times freeze the game. Use small values like 0.1.'},
        {'question_type': 'code-correction', 'text': 'The screen update shows flicker. Fix the update method.', 'code': 'screen.tracer(1)\nwhile True:\n    screen.update()', 'options': ['Turn off auto-update with screen.tracer(0)', 'Remove screen.update()', 'Use screen.refresh()', 'Set screen.tracer(100)'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'turtle', 'explanation': 'screen.tracer(0) disables auto-updates.'},
        {'question_type': 'code-correction', 'text': 'The snake segments are not following each other. Fix the movement.', 'code': 'for seg in segments:\n    seg.forward(20)', 'options': ['Move segments in reverse order: for seg in reversed(segments[1:]):', 'Use segments.sort()', 'Remove the loop', 'Move head first'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'game_logic', 'explanation': 'Each segment should move to the position of the one ahead.'},
    ],
    21: [
        {'question_type': 'code-correction', 'text': 'The snake can reverse direction into itself. Prevent it.', 'code': 'if key == "Down":\n    snake.direction = "down"', 'options': ['Check current direction: if snake.direction != "up":', 'Use snake.safe_move()', 'Add collision check', 'Ignore key input'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'game_logic', 'explanation': 'Prevent 180-degree turns by checking current direction.'},
        {'question_type': 'code-correction', 'text': 'The scoreboard is not displaying correctly. Debug the turtle write.', 'code': 'scoreboard.write(score)', 'options': ['Add alignment and font: write(score, align="center", font=("Arial", 24, "normal"))', 'Use scoreboard.print(score)', 'Use print(score)', 'Use scoreboard.text = score'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'turtle', 'explanation': 'Turtle write() accepts align and font parameters.'},
        {'question_type': 'code-correction', 'text': 'The inherited class is not getting parent methods. Fix it.', 'code': 'class Scoreboard(Turtle):\n    def __init__(self):\n        self.score = 0', 'options': ['Call parent init: super().__init__()', 'Use Turtle.__init__()', 'Add self.Turtle()', 'Import Turtle'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'inheritance', 'explanation': 'Call super().__init__() in child __init__.'},
    ],
    22: [
        {'question_type': 'code-correction', 'text': 'The paddle moves too slowly. Fix the movement increment.', 'code': 'def go_up(self):\n    self.sety(self.ycor() + 10)', 'options': ['Increase the step: self.sety(self.ycor() + 20)', 'Use self.forward(10)', 'Multiply by speed', 'Use time.sleep(0)'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'game_logic', 'explanation': 'Increase the y increment for faster paddle movement.'},
        {'question_type': 'code-correction', 'text': 'The ball bounces incorrectly off wall. Fix the angle calculation.', 'code': 'ball.bounce_x()', 'options': ['Use heading calculation: ball.setheading(180 - ball.heading())', 'Use ball.reverse()', 'Use ball.reflect()', 'Add random bounce'], 'correct_index': 0, 'difficulty': 'hard', 'topic_tag': 'physics', 'explanation': 'Use heading calculation for proper reflection angle.'},
        {'question_type': 'code-correction', 'text': 'The game detects collision too late. Fix the distance check.', 'code': 'if ball.distance(paddle) < 50 and ball.xcor() < -350:', 'options': ['Check collision before the wall: ball.xcor() > -350', 'Use collision library', 'Make paddle wider', 'Check every frame'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'collision', 'explanation': 'Check collision before the ball passes the paddle.'},
    ],
    23: [
        {'question_type': 'code-correction', 'text': 'The cars are not appearing randomly. Fix spawn logic.', 'code': 'car.goto(-300, 0)', 'options': ['Add random y: car.goto(-300, random.randint(-250, 250))', 'Use car.random_position()', 'Set car.y = random', 'Move to random x'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'random', 'explanation': 'Use random.randint() to spawn cars at different y positions.'},
        {'question_type': 'code-correction', 'text': 'The turtle cannot cross because cars are too fast. Debug timing.', 'code': 'car_speed = 50\ncar.forward(car_speed)', 'options': ['Start with lower speed: car_speed = 5', 'Use time.sleep()', 'Make turtle faster', 'Remove car_speed'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'game_balance', 'explanation': 'Start with slower car speed.'},
        {'question_type': 'code-correction', 'text': 'New cars spawn every frame causing lag. Fix spawn rate.', 'code': 'while True:\n    new_car = Car()', 'options': ['Add random chance: if random.randint(1, 6) == 1:', 'Remove the loop', 'Limit car count', 'Use object pooling'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'game_logic', 'explanation': 'Use random chance to control car creation rate.'},
    ],
    24: [
        {'question_type': 'code-correction', 'text': 'The file content is not being read. Debug the file mode.', 'code': 'with open("data.txt", "w") as file:\n    content = file.read()', 'options': ['Use read mode: open("data.txt", "r")', 'Use file.get()', 'Use file.content()', 'Remove the with'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'files', 'explanation': 'Mode "w" is for writing. Use "r" for reading.'},
        {'question_type': 'code-correction', 'text': 'The file path is not found. Fix the relative path.', 'code': 'open("data/file.txt")', 'options': ['Check path or use absolute path: open("./file.txt")', 'Use file://data/file.txt', 'Use os.find()', 'Add try/except'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'paths', 'explanation': 'Relative paths are from the working directory.'},
        {'question_type': 'code-correction', 'text': 'The file write is missing data. Debug the flush.', 'code': 'file = open("log.txt", "w")\nfile.write("log entry")', 'options': ['Close file or use with: file.close()', 'Use file.flush()', 'Use file.save()', 'Write twice'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'files', 'explanation': 'Always close files or use "with" to flush data.'},
    ],
    25: [
        {'question_type': 'code-correction', 'text': 'The CSV reading returns dict instead of values. Debug pandas.', 'code': 'import pandas\ndf = pandas.read_csv("data.csv")\nfor row in df:', 'options': ['Use iterrows(): for index, row in df.iterrows():', 'Use df.rows()', 'Use df.values()', 'Use for row in df.data:'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'pandas', 'explanation': 'Use iterrows() for row-by-row access.'},
        {'question_type': 'code-correction', 'text': 'The DataFrame column access fails. Fix the syntax.', 'code': 'df = pandas.read_csv("data.csv")\ncities = df.City', 'options': ['Use bracket notation: df["City"]', 'Use df.get(City)', 'Use df.column("City")', 'Import City first'], 'correct_index': 0, 'difficulty': 'easy', 'topic_tag': 'pandas', 'explanation': 'Use bracket notation df["column"] for reliable access.'},
        {'question_type': 'code-correction', 'text': 'The to_dict() is not giving expected format. Fix the parameter.', 'code': 'result = df.to_dict()', 'options': ['Use records format: df.to_dict(orient="records")', 'Use df.to_rows()', 'Use list(df)', 'Transpose first'], 'correct_index': 0, 'difficulty': 'medium', 'topic_tag': 'pandas', 'explanation': 'to_dict(orient="records") gives a list of row dictionaries.'},
    ],
}

for day, questions in cc_questions.items():
    path = Path(f'scripts/data/questions/day-{day}.json')
    with open(path, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    data.extend(questions)
    
    with open(path, 'w', encoding='utf-8') as f:
        json.dump(data, f, indent=2, ensure_ascii=False)
    
    print(f'Day {day}: Added {len(questions)} CC questions (total: {len(data)})')

print('Done!')
